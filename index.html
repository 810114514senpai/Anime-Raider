<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime-Raider</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            background-image: url('https://cdn.discordapp.com/attachments/1379153981544333375/1379546528389267628/IMG5008.jpg?ex=6840a253&is=683f50d3&hm=4b726dc640d8900224277a6539b9b52e609ecf104e318219546abfc0e920fa69&');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #eee;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* ç”»é¢ä¸Šéƒ¨ã«å¯„ã›ã‚‹ */
            min-height: 100vh;
            padding: 20px; /* å…¨ä½“ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¿½åŠ  */
            box-sizing: border-box;
        }
        .overlay {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            max-width: 800px; /* æœ€å¤§å¹…ã‚’åºƒãã™ã‚‹ */
            width: 100%;
            box-sizing: border-box;
            margin-top: 20px; /* ä¸Šéƒ¨ã®ä½™ç™½ */
            margin-bottom: 20px; /* ä¸‹éƒ¨ã®ä½™ç™½ */
        }
        .container {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #00bfff;
            text-align: center;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #c0c0c0;
        }
        input[type="text"],
        textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #555;
            border-radius: 4px;
            box-sizing: border-box;
            background-color: #333;
            color: #eee;
        }
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        .slider-group {
            margin-bottom: 20px;
        }
        .slider-group label {
            margin-bottom: 5px;
        }
        .slider-group input[type="range"] {
            width: calc(100% - 20px);
            margin-top: 5px;
            -webkit-appearance: none;
            height: 8px;
            background: #555;
            border-radius: 5px;
            outline: none;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #00bfff;
            cursor: pointer;
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
        }
        .checkbox-group {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            flex-grow: 1;
        }
        button:hover {
            background-color: #0056b3;
        }
        button#stopButton {
            background-color: #dc3545;
        }
        button#stopButton:hover {
            background-color: #c82333;
        }
        #status {
            margin-top: 25px;
            padding: 15px;
            border-radius: 5px;
            background-color: #222;
            color: #eee;
            border: 1px solid #444;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
        .success {
            background-color: #28a745;
            color: white;
        }
        .error {
            background-color: #dc3545;
            color: white;
        }
        .rate-limited {
            background-color: #ffc107;
            color: #343a40;
        }
        /* New styles for Poll options */
        .poll-option-input {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .poll-option-input input {
            margin-bottom: 0;
            flex-grow: 1;
        }
        .poll-option-input button {
            width: auto;
            padding: 8px 12px;
            margin-left: 10px;
            background-color: #6c757d;
            border: none;
        }
        .poll-option-input button:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
    <div class="overlay">
        <div class="container">
            <h1>Anime-Raider</h1>

            <label for="tokenInput">Discordãƒˆãƒ¼ã‚¯ãƒ³:</label>
            <textarea id="tokenInput" placeholder="Discordãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§å…¥åŠ›"></textarea>

            <label for="channelIdInput">ãƒãƒ£ãƒ³ãƒãƒ«ID:</label>
            <textarea id="channelIdInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«IDã‚’æ”¹è¡ŒåŒºåˆ‡ã‚Šã§å…¥åŠ›"></textarea>

            <label for="messageInput">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:</label>
            <textarea id="messageInput" placeholder="é€ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ› (æŠ•ç¥¨ã‚’é€ä¿¡ã™ã‚‹å ´åˆã€ã“ã“ã¯æŠ•ç¥¨ã®è£œè¶³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™)"></textarea>

            <div class="slider-group">
                <label for="speedSlider">é€ä¿¡é€Ÿåº¦ (é–“éš”: <span id="speedValue">1000</span> ms) - å³ã«ã™ã‚‹ã¨é€Ÿããªã‚Šã¾ã™</label>
                <input type="range" id="speedSlider" min="100" max="10000" value="1000" oninput="document.getElementById('speedValue').textContent=this.value">
            </div>

            <div class="slider-group">
                <label for="countSlider">é€ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: <span id="countValue">1</span></label>
                <input type="range" id="countSlider" min="1" max="50" value="1" oninput="document.getElementById('countValue').textContent=this.value">
            </div>

            <div class="slider-group">
                <label for="mentionCountSlider">ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: <span id="mentionCountValue">0</span></label>
                <input type="range" id="mentionCountSlider" min="0" max="10" value="0" oninput="document.getElementById('mentionCountValue').textContent=this.value">
            </div>

            <label for="mentionIdsInput">ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ID (ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Š):</label>
            <input type="text" id="mentionIdsInput" placeholder="ä¾‹: 123456789012345678,987654321098765432">

            <div class="checkbox-group">
                <input type="checkbox" id="addRandomStringCheckbox" onchange="toggleRandomStringSlider()">
                <label for="addRandomStringCheckbox">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ—ã‚’è¿½åŠ </label>
            </div>

            <div class="slider-group" id="randomStringLengthGroup" style="display: none;">
                <label for="randomStringLengthSlider">ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã®é•·ã•: <span id="randomStringLengthValue">5</span></label>
                <input type="range" id="randomStringLengthSlider" min="1" max="20" value="5" oninput="document.getElementById('randomStringLengthValue').textContent=this.value">
            </div>

            <hr>
            <h2>ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</h2>

            <div class="checkbox-group">
                <input type="checkbox" id="enableReplyCheckbox" onchange="toggleReplyInput()">
                <label for="enableReplyCheckbox">æŒ‡å®šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«è¿”ä¿¡ã™ã‚‹</label>
            </div>
            <div id="replyToMessageGroup" style="display: none;">
                <label for="replyToMessageIdInput">è¿”ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID:</label>
                <input type="text" id="replyToMessageIdInput" placeholder="è¿”ä¿¡å…ˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸IDã‚’å…¥åŠ›">
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="enablePollCheckbox" onchange="togglePollOptions()">
                <label for="enablePollCheckbox">æŠ•ç¥¨ã‚’ä½œæˆã™ã‚‹</label>
            </div>
            <div id="pollOptionsGroup" style="display: none;">
                <label for="pollQuestionInput">æŠ•ç¥¨ã®è³ªå•:</label>
                <input type="text" id="pollQuestionInput" placeholder="ä¾‹: ä»Šæ—¥ã®ãƒ©ãƒ³ãƒã¯ä½•ã«ã™ã‚‹ï¼Ÿ">

                <label>æŠ•ç¥¨ã®é¸æŠè‚¢:</label>
                <div id="pollOptionsContainer">
                    <div class="poll-option-input">
                        <input type="text" class="poll-option" placeholder="é¸æŠè‚¢1">
                        <button onclick="removePollOption(this)">å‰Šé™¤</button>
                    </div>
                    <div class="poll-option-input">
                        <input type="text" class="poll-option" placeholder="é¸æŠè‚¢2">
                        <button onclick="removePollOption(this)">å‰Šé™¤</button>
                    </div>
                </div>
                <button onclick="addPollOption()">é¸æŠè‚¢ã‚’è¿½åŠ </button>
                <br><br>
                <label for="pollDurationSlider">æŠ•ç¥¨ã®æœŸé–“ (æ™‚é–“): <span id="pollDurationValue">24</span></label>
                <input type="range" id="pollDurationSlider" min="1" max="168" value="24" oninput="document.getElementById('pollDurationValue').textContent=this.value">
            </div>

            <hr>

            <div class="button-group">
                <button onclick="startSending()">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡</button>
                <button id="stopButton" onclick="stopSending()" disabled>é€ä¿¡ã‚’åœæ­¢</button>
            </div>

            <div id="status">ã“ã“ã«é€ä¿¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
        </div>
    </div>

    <script>
        let isSending = false;
        let stopRequested = false;

        const allEmojis = [
            'ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†', 'ğŸ˜…', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ™‚', 'ğŸ™ƒ', 'ğŸ˜‰', 'ğŸ˜Œ', 'ğŸ˜', 'ğŸ¥°', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š',
            'ğŸ˜‹', 'ğŸ˜›', 'ğŸ˜', 'ğŸ˜œ', 'ğŸ¤ª', 'ğŸ¤¨', 'ğŸ§', 'ğŸ¤“', 'ğŸ˜', 'ğŸ¤©', 'ğŸ¥³', 'ğŸ˜', 'ğŸ˜’', 'ğŸ˜', 'ğŸ˜”', 'ğŸ˜Ÿ', 'ğŸ˜•', 'ğŸ¥º', 'ğŸ˜¤', 'ğŸ˜ ',
            'ğŸ˜¡', 'ğŸ¤¬', 'ğŸ¤¯', 'ğŸ˜³', 'ğŸ¥µ', 'ğŸ¥¶', 'ğŸ˜±', 'ğŸ˜¨', 'ğŸ˜°', 'ğŸ˜¥', 'ğŸ˜¢', 'ğŸ˜­', 'ğŸ¤¥', 'ğŸ¤«', 'ğŸ¤­', ' discreet', 'ğŸ¤”', 'ğŸ¤', 'ğŸ¤«', ' render',
            'ğŸ¤¢', 'ğŸ¤®', 'ğŸ¤§', 'ğŸ˜·', 'ğŸ¤’', 'ğŸ¤•', 'ğŸ¤‘', 'ğŸ¤ ', 'ğŸ¥³', 'ğŸ˜', 'ğŸ¤“', 'ğŸ§', 'ğŸ¤¯', 'ğŸ¤«', 'ğŸ¤”', 'ğŸ¤¥', 'ğŸ˜¶', 'ğŸ˜', 'ğŸ˜‘', 'ğŸ˜¬', 'ğŸ™„',
            'ğŸ˜¤', 'ğŸ˜ ', 'ğŸ˜¡', 'ğŸ¤¬', 'ğŸ˜ˆ', 'ğŸ‘¿', 'ğŸ’€', 'â˜ ï¸', 'ğŸ’©', 'ğŸ¤¡', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ‘»', 'ğŸ‘½', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ˜º', 'ğŸ˜¸', 'ğŸ˜¹', 'ğŸ˜»',
            'ğŸ˜¼', 'ğŸ˜½', 'ğŸ™€', 'ğŸ˜¿', 'ğŸ˜¾', 'ğŸ‘‹', 'ğŸ¤š', 'ğŸ–ï¸', 'âœ‹', 'ğŸ––', 'ğŸ‘Œ', 'ğŸ¤', 'âœŒï¸', 'ğŸ¤', 'ğŸ¤™', 'ğŸ¤˜', 'ğŸ¤Ÿ', 'ğŸ‘', 'ğŸ™Œ', 'ğŸ‘',
            'ğŸ¤²', 'ğŸ¤', 'ğŸ™', 'âœï¸', 'ğŸ’…', 'ğŸ¤³', 'ğŸ’ª', 'ğŸ¦µ', 'ğŸ¦¶', 'ğŸ‘‚', 'ğŸ‘ƒ', 'ğŸ§ ', 'ğŸ«€', 'ğŸ«', 'ğŸ¦·', 'ğŸ¦´', 'ğŸ‘€', 'ğŸ‘ï¸', 'ğŸ‘…', 'ğŸ‘„',
            'ğŸ’‹', 'ğŸ©¸', 'ğŸ¦ ', 'ğŸ©»', 'ğŸ’‰', 'ğŸ’Š', 'ğŸ©¹', 'ğŸ©¼', 'ğŸ©±', 'ğŸ©²', 'ğŸ©³', 'ğŸ©´', 'ğŸ‘™', 'ğŸ‘š', 'ğŸ‘•', 'ğŸ‘–', 'ğŸ‘Ÿ', 'ğŸ‘', 'ğŸ‘ ', 'ğŸ‘¡',
            'ğŸ‘¢', 'ğŸ¥¿', 'ğŸ©°', 'ğŸ©', 'ğŸ‘‘', 'ğŸ‘’', 'ğŸ“', 'ğŸ§¢', 'ğŸ—ï¸', 'ğŸ½', 'ğŸ§£', 'ğŸ§¤', 'ğŸ§¥', 'ğŸ§¦', 'ğŸ‘—', 'ğŸ‘˜', 'ğŸ¥»', 'ğŸ©±', 'ğŸ©²', 'ğŸ©³',
            'ğŸ©´', 'ğŸ‘™', 'ğŸ’¼', 'ğŸ’', 'ğŸ‘œ', 'ğŸ‘›', 'ğŸ‘', 'ğŸ›ï¸', 'ğŸ›’', 'ğŸ', 'ğŸ€', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ‹', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ', 'ğŸ‘',
            'ğŸ§§', 'ğŸ‡', 'ğŸ†', ' sparkles', 'ğŸ’«', 'ğŸŒŸ', 'âœ¨', 'âš¡', 'ğŸ”¥', 'ğŸ’¥', 'â˜„ï¸', 'â˜€ï¸', 'ğŸŒ', 'ğŸŒ›', 'ğŸŒœ', 'ğŸŒ‘', 'ğŸŒ“', 'ğŸŒ”', 'ğŸŒ•', 'ğŸŒ–',
            'ğŸŒ—', 'ğŸŒ˜', 'ğŸŒ™', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸ—ºï¸', 'ğŸ—¾', 'ğŸ§­', 'ğŸ”ï¸', 'â›°ï¸', 'ğŸŒ‹', 'ğŸ—»', 'ğŸ•ï¸', 'ğŸ–ï¸', 'ğŸœï¸', 'ğŸï¸', 'ğŸï¸', 'ğŸ›£ï¸',
            ' railway_track', ' bridge_at_night', ' cityscape', ' night_with_stars', ' milky_way', ' on_coming_automobile', ' taxi', ' red_car',
            ' blue_car', ' truck', 'articulated_lorry', 'bus', 'oncoming_bus', 'racing_car', 'motorcycle', 'scooter', 'bike', 'motor_scooter',
            'police_car', 'oncoming_police_car', 'fire_engine', 'ambulance', 'minibus', 'delivery_truck', 'ferry', 'speedboat', 'boat',
            'canoe', 'sailboat', 'passenger_ship', 'flight_avion', 'helicopter', 'train', 'mountain_railway', 'steam_locomotive',
            'bullettrain_side', 'bullettrain_front', 'tram', 'monorail', 'station', 'aerial_tramway', 'suspension_railway', 'vertical_traffic_light',
            'horizontal_traffic_light', 'construction', 'road_work', 'classical_building', 'post_office', 'hospital', 'bank', 'hotel', 'love_hotel',
            'convenience_store', 'school', 'department_store', 'factory', 'japanese_castle', 'european_castle', 'wedding', 'tokyo_tower',
            'statue_of_liberty', 'church', 'mosque', 'synagogue', 'kaaba', 'shinto_shrine', 'crossed_flags', 'fountain', 'tent', 'foggy',
            'night_clear', 'stars', 'cloud', 'partly_sunny', 'thunder_cloud_and_rain', 'rainbow', 'bridge_at_night', 'volcano', 'milky_way',
            'ocean', 'cat', 'dog', 'mouse', 'hamster', 'rabbit', 'fox', 'bear', 'panda', 'koala', 'tiger', 'lion', 'cow', 'pig', 'boar',
            'monkey', 'gorilla', 'orangutan', 'chicken', 'penguin', 'bird', 'baby_chick', 'hatching_chick', 'eagle', 'duck', 'swan',
            'owl', 'bat', 'wolf', 'wild_boar', 'horse', 'unicorn', 'honeybee', 'bug', 'butterfly', 'snail', 'beetle', 'ant', 'mosquito',
            'cricket', 'spider', 'scorpion', 'turtle', 'snake', 'lizard', 't-rex', 'sauropod', 'octopus', 'squid', 'shrimp', 'lobster',
            'crab', 'blowfish', 'tropical_fish', 'fish', 'dolphin', 'whale', 'shark', 'crocodile', 'leopard', 'zebra', 'kangaroo',
            'badger', 'otter', 'hedgehog', 'skunk', 'racoon', 'llama', 'hippo', 'parrot', 'peacock', 'platypus', 'polar_bear', 'rhinoceros',
            'seal', 'walrus', 'kangaroo', 'owl', 'bat', 'wolf', 'wild_boar', 'horse', 'unicorn', 'honeybee', 'bug', 'butterfly', 'snail',
            'beetle', 'ant', 'mosquito', 'cricket', 'spider', 'scorpion', 'turtle', 'snake', 'lizard', 't-rex', 'sauropod', 'octopus',
            'squid', 'shrimp', 'lobster', 'crab', 'blowfish', 'tropical_fish', 'fish', 'dolphin', 'whale', 'shark', 'crocodile', 'leopard',
            'zebra', 'kangaroo', 'badger', 'otter', 'hedgehog', 'skunk', 'racoon', 'llama', 'hippo', 'parrot', 'peacock', 'platypus',
            'polar_bear', 'rhinoceros', 'seal', 'walrus', 'kangaroo', 'owl', 'bat', 'wolf', 'wild_boar', 'horse', 'unicorn', 'honeybee',
            'bug', 'butterfly', 'snail', 'beetle', 'ant', 'mosquito', 'cricket', 'spider', 'scorpion', 'turtle', 'snake', 'lizard',
            't-rex', 'sauropod', 'octopus', 'squid', 'shrimp', 'lobster', 'crab', 'blowfish', 'tropical_fish', 'fish', 'dolphin', 'whale',
            'shark', 'crocodile', 'leopard', 'zebra', 'kangaroo', 'badger', 'otter', 'hedgehog', 'skunk', 'racoon', 'llama', 'hippo',
            'parrot', 'peacock', 'platypus', 'polar_bear', 'rhinoceros', 'seal', 'walrus', ' kangaroo'
        ];

        function generateRandomString(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }

        function getRandomEmoji() {
            return allEmojis[Math.floor(Math.random() * allEmojis.length)];
        }

        function toggleRandomStringSlider() {
            const checkbox = document.getElementById('addRandomStringCheckbox');
            const sliderGroup = document.getElementById('randomStringLengthGroup');
            if (checkbox.checked) {
                sliderGroup.style.display = 'block';
            } else {
                sliderGroup.style.display = 'none';
            }
        }

        function toggleReplyInput() {
            const checkbox = document.getElementById('enableReplyCheckbox');
            const replyGroup = document.getElementById('replyToMessageGroup');
            if (checkbox.checked) {
                replyGroup.style.display = 'block';
            } else {
                replyGroup.style.display = 'none';
            }
        }

        function togglePollOptions() {
            const checkbox = document.getElementById('enablePollCheckbox');
            const pollGroup = document.getElementById('pollOptionsGroup');
            if (checkbox.checked) {
                pollGroup.style.display = 'block';
            } else {
                pollGroup.style.display = 'none';
            }
        }

        function addPollOption() {
            const container = document.getElementById('pollOptionsContainer');
            const optionCount = container.querySelectorAll('.poll-option').length;
            const newOptionDiv = document.createElement('div');
            newOptionDiv.className = 'poll-option-input';
            newOptionDiv.innerHTML = `
                <input type="text" class="poll-option" placeholder="é¸æŠè‚¢${optionCount + 1}">
                <button onclick="removePollOption(this)">å‰Šé™¤</button>
            `;
            container.appendChild(newOptionDiv);
        }

        function removePollOption(buttonElement) {
            const parentDiv = buttonElement.parentNode;
            parentDiv.remove();
        }

        function stopSending() {
            stopRequested = true;
            document.getElementById('status').textContent += "\n\n--- é€ä¿¡åœæ­¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ã¾ã—ãŸã€‚ç¾åœ¨ã®å‡¦ç†ãŒå®Œäº†æ¬¡ç¬¬åœæ­¢ã—ã¾ã™ã€‚ ---";
            document.querySelector('button').disabled = false;
            document.getElementById('stopButton').disabled = true;
        }

        async function startSending() {
            if (isSending) {
                alert("ã™ã§ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ä¸­ã§ã™ã€‚");
                return;
            }

            const tokensRaw = document.getElementById('tokenInput').value;
            const channelIdsRaw = document.getElementById('channelIdInput').value;
            let baseMessage = document.getElementById('messageInput').value;
            const speedSliderValue = parseInt(document.getElementById('speedSlider').value, 10);
            const sendInterval = 10100 - speedSliderValue;
            
            const messageCount = parseInt(document.getElementById('countSlider').value, 10);
            const mentionCount = parseInt(document.getElementById('mentionCountSlider').value, 10);
            const mentionIdsRaw = document.getElementById('mentionIdsInput').value;
            const addRandomString = document.getElementById('addRandomStringCheckbox').checked;
            const randomStringLength = parseInt(document.getElementById('randomStringLengthSlider').value, 10);
            
            const enableReply = document.getElementById('enableReplyCheckbox').checked;
            const replyToMessageId = document.getElementById('replyToMessageIdInput').value.trim();

            const enablePoll = document.getElementById('enablePollCheckbox').checked;
            const pollQuestion = document.getElementById('pollQuestionInput').value.trim();
            const pollOptionsElements = document.querySelectorAll('.poll-option');
            const pollOptions = Array.from(pollOptionsElements).map(input => input.value.trim()).filter(val => val.length > 0);
            const pollDuration = parseInt(document.getElementById('pollDurationSlider').value, 10); // in hours

            const statusDiv = document.getElementById('status');

            const tokens = tokensRaw.split('\n').map(t => t.trim()).filter(t => t.length > 0);
            const channelIds = channelIdsRaw.split('\n').map(id => id.trim()).filter(id => id.length > 0);
            const mentionIds = mentionIdsRaw.split(',').map(id => id.trim()).filter(id => id.length > 0);

            if (tokens.length === 0) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: Discordãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                return;
            }
            if (channelIds.length === 0) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: ãƒãƒ£ãƒ³ãƒãƒ«IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                return;
            }
            if (!baseMessage && !enablePoll) { // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚æŠ•ç¥¨ã‚‚ç„¡ã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼
                statusDiv.className = 'error';
                statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: é€ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã™ã‚‹ã‹ã€æŠ•ç¥¨ã‚’ä½œæˆã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚';
                return;
            }
            if (enableReply && replyToMessageId.length === 0) {
                statusDiv.className = 'error';
                statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: è¿”ä¿¡ã‚’æœ‰åŠ¹ã«ã™ã‚‹å ´åˆã€è¿”ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                return;
            }
            if (enablePoll) {
                if (pollQuestion.length === 0) {
                    statusDiv.className = 'error';
                    statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: æŠ•ç¥¨ã®è³ªå•ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                    return;
                }
                if (pollOptions.length < 2) {
                    statusDiv.className = 'error';
                    statusDiv.textContent = 'ã‚¨ãƒ©ãƒ¼: æŠ•ç¥¨ã«ã¯å°‘ãªãã¨ã‚‚2ã¤ã®é¸æŠè‚¢ãŒå¿…è¦ã§ã™ã€‚';
                    return;
                }
            }


            isSending = true;
            stopRequested = false;
            statusDiv.className = '';
            statusDiv.textContent = 'é€ä¿¡ã‚’é–‹å§‹ã—ã¾ã™...';
            document.querySelector('button').disabled = true;
            document.getElementById('stopButton').disabled = false;

            let successfulSends = 0;
            let failedSends = 0;
            let rateLimitedCount = 0;
            let currentTokenIndex = 0;

            for (let i = 0; i < messageCount; i++) {
                if (stopRequested) {
                    statusDiv.textContent += `\n\n--- é€ä¿¡ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦åœæ­¢ã•ã‚Œã¾ã—ãŸ ---\nåˆè¨ˆé€ä¿¡è©¦è¡Œæ•°: ${messageCount * channelIds.length}\næˆåŠŸ: ${successfulSends}\nå¤±æ•—: ${failedSends}\nãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆé­é‡: ${rateLimitedCount}`;
                    break;
                }

                const currentToken = tokens[currentTokenIndex];

                for (const channelId of channelIds) {
                    if (stopRequested) {
                        statusDiv.textContent += `\n\n--- é€ä¿¡ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦åœæ­¢ã•ã‚Œã¾ã—ãŸ ---\nåˆè¨ˆé€ä¿¡è©¦è¡Œæ•°: ${messageCount * channelIds.length}\næˆåŠŸ: ${successfulSends}\nå¤±æ•—: ${failedSends}\nãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆé­é‡: ${rateLimitedCount}`;
                        break;
                    }

                    let payload = {
                        "content": baseMessage,
                        "tts": false
                    };

                    // ãƒ©ãƒ³ãƒ€ãƒ ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
                    if (mentionIds.length > 0 && mentionCount > 0) {
                        const shuffledMentionIds = [...mentionIds].sort(() => 0.5 - Math.random());
                        const selectedMentions = shuffledMentionIds.slice(0, Math.min(mentionCount, mentionIds.length));
                        payload.content += selectedMentions.map(id => ` <@${id}>`).join('');
                    }

                    // ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã‚’è¿½åŠ 
                    if (addRandomString) {
                        payload.content += ` ${generateRandomString(randomStringLength)}`;
                    }

                    // ãƒ©ãƒ³ãƒ€ãƒ ãªçµµæ–‡å­—ã‚’è¿½åŠ 
                    payload.content += ` ${getRandomEmoji()}`;

                    // è¿”ä¿¡æ©Ÿèƒ½
                    if (enableReply && replyToMessageId.length > 0) {
                        payload.message_reference = {
                            "channel_id": channelId, // è¿”ä¿¡ã™ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«IDã¯é€ä¿¡å…ˆã¨åŒã˜
                            "message_id": replyToMessageId
                        };
                        payload.allowed_mentions = {
                            "parse": ["users", "roles", "everyone"], // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³è¨­å®š
                            "replied_user": true // è¿”ä¿¡å…ˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã™ã‚‹ã‹ã©ã†ã‹
                        };
                    }

                    // æŠ•ç¥¨æ©Ÿèƒ½
                    if (enablePoll) {
                        payload.poll = {
                            "question": {
                                "text": pollQuestion
                            },
                            "answers": pollOptions.map((option, index) => ({
                                "poll_media": {
                                    "text": option
                                }
                            })),
                            "duration": pollDuration * 3600, // Duration in seconds (Discord API expects seconds)
                            "allow_multiselect": false // è¤‡æ•°é¸æŠã‚’è¨±å¯ã—ãªã„ (ä»»æ„ã§å¤‰æ›´å¯èƒ½)
                        };
                        // æŠ•ç¥¨ã‚’ä½œæˆã™ã‚‹å ´åˆã€contentã¯æŠ•ç¥¨ã®è£œè¶³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹
                        // contentãŒç©ºã®å ´åˆã€Discord APIã«ã‚ˆã£ã¦ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ç©ºã§ãªã„ã“ã¨ã‚’ç¢ºèª
                        if (payload.content.trim() === '') {
                             payload.content = "æŠ•ç¥¨ãŒé–‹å§‹ã•ã‚Œã¾ã—ãŸï¼"; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                        }
                    }

                    const headers = {
                        "Authorization": currentToken,
                        "Content-Type": "application/json",
                    };

                    try {
                        const response = await fetch(`https://discord.com/api/v9/channels/${channelId}/messages`, {
                            method: 'POST',
                            headers: headers,
                            body: JSON.stringify(payload)
                        });

                        const responseText = await response.text();

                        if (response.ok) {
                            successfulSends++;
                            statusDiv.className = 'success';
                            statusDiv.textContent = `[+] (${i + 1}/${messageCount}) ãƒãƒ£ãƒ³ãƒãƒ« ${channelId} ã«${enablePoll ? 'æŠ•ç¥¨ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸' : 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸'}ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚(ãƒˆãƒ¼ã‚¯ãƒ³: ${currentTokenIndex + 1}/${tokens.length})\næˆåŠŸ: ${successfulSends}, å¤±æ•—: ${failedSends}, ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆ: ${rateLimitedCount}`;
                        } else if (response.status === 429) {
                            rateLimitedCount++;
                            const retryAfter = response.headers.get('Retry-After');
                            statusDiv.className = 'rate-limited';
                            statusDiv.textContent = `[!] (${i + 1}/${messageCount}) ãƒãƒ£ãƒ³ãƒãƒ« ${channelId} ã§ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã«é”ã—ã¾ã—ãŸã€‚(ãƒˆãƒ¼ã‚¯ãƒ³: ${currentTokenIndex + 1}/${tokens.length}) ${retryAfter ? retryAfter + 'ç§’å¾Œã«å†è©¦è¡Œã—ã¾ã™ã€‚' : ''}\næˆåŠŸ: ${successfulSends}, å¤±æ•—: ${failedSends}, ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆ: ${rateLimitedCount}\nã‚¨ãƒ©ãƒ¼è©³ç´°: ${responseText}`;
                            if (retryAfter) {
                                await new Promise(resolve => setTimeout(resolve, parseInt(retryAfter, 10) * 1000 + 100));
                            }
                        } else {
                            failedSends++;
                            statusDiv.className = 'error';
                            statusDiv.textContent = `[-] (${i + 1}/${messageCount}) ãƒãƒ£ãƒ³ãƒãƒ« ${channelId} ã¸ã®${enablePoll ? 'æŠ•ç¥¨ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸' : 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸'}é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${response.status} ã‚¨ãƒ©ãƒ¼: ${responseText}\næˆåŠŸ: ${successfulSends}, å¤±æ•—: ${failedSends}, ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆ: ${rateLimitedCount}`;
                        }
                    } catch (error) {
                        failedSends++;
                        statusDiv.className = 'error';
                        statusDiv.textContent = `[-] (${i + 1}/${messageCount}) ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯äºˆæœŸã›ã¬ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}\næˆåŠŸ: ${successfulSends}, å¤±æ•—: ${failedSends}, ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆ: ${rateLimitedCount}`;
                        console.error("Fetch error:", error);
                    }
                    await new Promise(resolve => setTimeout(resolve, sendInterval));
                }
                currentTokenIndex = (currentTokenIndex + 1) % tokens.length;
            }

            if (!stopRequested) {
                statusDiv.textContent += `\n\n--- é€ä¿¡å®Œäº† ---\nåˆè¨ˆé€ä¿¡è©¦è¡Œæ•°: ${messageCount * channelIds.length}\næˆåŠŸ: ${successfulSends}\nå¤±æ•—: ${failedSends}\nãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆé­é‡: ${rateLimitedCount}`;
            }
            
            isSending = false;
            document.querySelector('button').disabled = false;
            document.getElementById('stopButton').disabled = true;
        }
    </script>
</body>
</html>
